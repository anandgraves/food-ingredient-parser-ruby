grammar IngredientNested
  include Common
  include Amount
  include IngredientSimple

  rule ingredient_nested
    ( name:ingredient_simple                  ws* '(' ws* contains:list ws* '.'? ws* ')' ws? mark:mark ws* amount:amount <NestedIngredientNode> ) /
    ( name:ingredient_simple                  ws* '(' ws* contains:list ws* '.'? ws* ')'                   amount:amount <NestedIngredientNode> ) /
    ( name:ingredient_simple_with_amount      ws* '(' ws* contains:list ws* '.'? ws* ')' ws? mark:mark                   <NestedIngredientNode> ) /
    ( name:ingredient_simple_with_amount      ws* '(' ws* contains:list ws* '.'? ws* ')'                                 <NestedIngredientNode> ) /
    ( name:ingredient_simple                  ws* '[' ws* contains:list ws* '.'? ws* ']' ws? mark:mark ws* amount:amount <NestedIngredientNode> ) /
    ( name:ingredient_simple                  ws* '[' ws* contains:list ws* '.'? ws* ']'                   amount:amount <NestedIngredientNode> ) /
    ( name:ingredient_simple_with_amount      ws* '[' ws* contains:list ws* '.'? ws* ']' ws? mark:mark                   <NestedIngredientNode> ) /
    ( name:ingredient_simple_with_amount      ws* '[' ws* contains:list ws* '.'? ws* ']'                                 <NestedIngredientNode> )
  end

end
